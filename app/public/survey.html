<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>FriendFinder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
</head>
<body>

<div class="container">
<br>
<h2>Survey Questions</h2>
<hr>
  
    <h4>About You</h4>
      <h6>Name (Required)</h6>
      <input type="text" name="Name" id="user-name">

      <h6>Link to Photo Image (Required)</h6>
      <input type="text" name="Photo" id="user-photo">
      <hr>

    <h6>Please answer the following questions on a scale from 1 (Strongly Disagree) to 5 (Strongly Agree)</h6>
    <br>

    <h4>Question 1</h4>
      <h6>Your mind is always buzzing with unexplored ideas and plans.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="first-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 2</h4>
      <h6>Generally speaking, you rely more on your experience than your imagination.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop2" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="second-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 3</h4>
      <h6>You find it easy to stay relaxed and focused even when there is some pressure.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop3" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="third-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 4</h4>
      <h6>You rarely do something just out of sheer curiosity.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop4" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="fourth-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 5</h4>
      <h6>People can rarely upset you.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop5" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="fifth-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 6</h4>
      <h6>It is often difficult for you to relate to other people’s feelings.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop6" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="sixth-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 7</h4>
      <h6>In a discussion, truth should be more important than people’s sensitivities.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop7" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="seventh-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 8</h4>
      <h6>You rarely get carried away by fantasies and ideas.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop8" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="eigth-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 9</h4>
      <h6>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop9" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu" id="ninth-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>

    <h4>Question 10</h4>
      <h6>You feel more energetic after spending time with a group of people.</h6>
      <div class="btn-group" role="group">
        <button id="btnGroupDrop10" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Select an Option
        </button>
        <div class="dropdown-menu"id="tenth-drop" aria-labelledby="btnGroupDrop1">
          <a class="dropdown-item" href="#">1</a>
          <a class="dropdown-item" href="#">2</a>
          <a class="dropdown-item" href="#">3</a>
          <a class="dropdown-item" href="#">4</a>
          <a class="dropdown-item" href="#">5</a>
        </div>
      </div>
      <br><br>


      <div class="text-center">
        <a href="/results"><button class="btn btn-lg btn-primary" id="submit-button" data-toggle="modal" data-target="#exampleModal"><span class="fa fa-list-alt"></span> Submit My Answers! </button></a>
      </div>
      <br><br>
</div>

      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
        
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary">Thank you for using Friend Finder!</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>

      <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

      <script>

      userArray = [];

      // THIS CODE CREATES ANIMATION TO OUR DROPDOWN BUTTONS.
      $("#first-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop1:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#second-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop2:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#third-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop3:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#fourth-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop4:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#fifth-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop5:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#sixth-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop6:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#seventh-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop7:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#eigth-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop8:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#ninth-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop9:first-child").html($(this).text());
        userArray.push($(this).text());
      });

      $("#tenth-drop a").one("click", function(){
        event.preventDefault();
        $("#btnGroupDrop10:first-child").html($(this).text());
        userArray.push($(this).text());
      });


      // THIS CODE RUNS THE QUERY AFTER THE USER CLICKS SUBMIT
       $("#submit-button").on("click", function(event) {
       event.preventDefault();

       var userName = $("#user-name").val().trim();
       var userPhoto = $("#user-photo").val().trim();

        console.log("User Choices: " + userArray);
        runTotalDifferenceQuery();
 
        function runTotalDifferenceQuery() {

        $.ajax({ url: "/api/friends", method: "GET" })
            .then(function(friendsData) {

            // console.log(friendsData);
            // console.log("------------------------------------");

            // This is the code where you determine the user's most compatible friend. 
            totalDifferenceZero = 0;
            totalDifferenceOne = 0;

            for (var i = 0; i < friendsData[0].scores.length; i++) {
                 totalDifferenceZero += Math.abs(friendsData[0].scores[i] - userArray[i]);
                }

            for (var i = 0; i < friendsData[1].scores.length; i++) {
                 totalDifferenceOne += Math.abs(friendsData[1].scores[i] - userArray[i]);
                }

                console.log(totalDifferenceZero);
                console.log(totalDifferenceOne);

                if (totalDifferenceZero < totalDifferenceOne) {
                  console.log(friendsData[0]);
                  $(".modal-title").html("<h1 align='center'> Hello " + userName + ". " + "Your match is <b>" + friendsData[0].name + "</b>!</h1>");
                  $(".modal-body").append(`<img src='${userPhoto}' alt='picture of user'>`);
                  $(".modal-body").append("<img src='https://cdn.shopify.com/s/files/1/0080/8372/products/tattly_classic_red_heart_team_tattly_00_1024x1024@2x.png?v=1531940498' alt='heart image' width='60px'>");
                  $(".modal-body").append(`<img src='${friendsData[0].photo}' alt='picture of friend'>`);    
                  // $(".modal-footer").prepend("<p>Thank you for using Friend Finder!</p>");            
                } 
                else if (totalDifferenceOne < totalDifferenceZero) {
                  console.log(friendsData[1]);
                  $(".modal-title").html("<h1 align='center'> Hello " + userName + ". " + "Your match is <b>" + friendsData[1].name + "</b>!</h1>");
                  $(".modal-body").append(`<img src='${userPhoto}' alt='picture of user'>`);
                  $(".modal-body").append("<img src='https://cdn.shopify.com/s/files/1/0080/8372/products/tattly_classic_red_heart_team_tattly_00_1024x1024@2x.png?v=1531940498' alt='heart image' width='60px'>");
                  $(".modal-body").append(`<img src='${friendsData[1].photo}' alt='picture of friend'>`);
                  // $(".modal-footer").prepend("<p>Thank you for using Friend Finder!</p>"); 
                }
            })
          }
        });
      
      </script>

    </body>
</html>
